var slider=$("#loop-slider"),imgGroup=$("#img-group"),img=$("#img-group li"),imgCount=img.length,firstImg=img.first(),lastImg=img.last();slider.data("autoplay")?autoplay=slider.data("autoplay"):autoplay=!1,slider.data("speed")?gallerySpeed=slider.data("speed"):gallerySpeed=8e3,imgGroup.css("width",100*(imgCount+2)+"vw");var controlsHTML='<div class="control-container"><div class="controls prev"></i></div><div class="controls next"></div></div>',controls=document.createElement("div");controls.innerHTML=controlsHTML,document.getElementById("loop-slider").appendChild(controls),firstImg.clone().addClass("clone").appendTo(imgGroup),lastImg.clone().addClass("clone").prependTo(imgGroup),(img=$("#img-group li")).each(function(){var i=$(this),t=i.data("img");i.css("background-image","url("+t+")")});var position=-100,slidew=100,duration=.3,delay=1e3*duration+1,endPosition=-100*imgCount;function nextSlide(){position-=slidew,imgGroup.css({transform:"translateX("+position+"vw)","transition-duration":+duration+"s"})}function prevSlide(){position+=slidew,imgGroup.css({transform:"translateX("+position+"vw)","transition-duration":+duration+"s"})}function rotateSlide(){setTimeout(function(){imgGroup.css({"transition-duration":"0s",transform:"translateX("+position+"vw)"})},delay)}function rotate(){position==endPosition?(nextSlide(),position=-100,rotateSlide()):nextSlide()}if($(".next").click(function(){position>endPosition+1?nextSlide():(nextSlide(),position=-100,rotateSlide())}),$(".prev").click(function(){position<-101?prevSlide():(prevSlide(),position=endPosition,rotateSlide())}),$(document).keydown(function(i){switch(i.which){case 39:position>endPosition+1?nextSlide():(nextSlide(),position=-100,rotateSlide());break;case 37:position<-101?prevSlide():(prevSlide(),position=endPosition,rotateSlide());break;default:return}i.preventDefault()}),"1"==autoplay){var speed=gallerySpeed,timer=setInterval(rotate,speed);slider.hover(function(){clearInterval(timer)},function(){timer=setInterval(rotate,speed)}),slider.keypress(function(){clearInterval(timer)},function(){timer=setInterval(rotate,speed)})}
